(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"warnOnce",{enumerable:!0,get:function(){return r}});let r=e=>{}},54858,e=>{"use strict";let t="http://localhost:8080/api";e.s(["api",0,{async getRentals(){let e=await fetch(`${t}/rentals`);if(!e.ok)throw Error("Failed to fetch rentals");return(await e.json()).data||[]},async createRental(e,a,r){let s=await fetch(`${t}/rentals/rent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({memberId:e,bookId:a,dueDate:r})});if(!s.ok)throw Error("Failed to create rental");return(await s.json()).data},async returnRental(e,a){let r=await fetch(`${t}/rentals/return/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({returnDate:a})});if(!r.ok)throw Error("Failed to return rental");return(await r.json()).data},async getMembers(){let e=await fetch(`${t}/members`);if(!e.ok)throw Error("Failed to fetch members");return(await e.json()).data||[]},async createMember(e,a,r){let s=await fetch(`${t}/members`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:a,username:r})});if(!s.ok)throw Error("Failed to create member");return(await s.json()).data},async updateMember(e,a,r){let s=await fetch(`${t}/members/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,email:r})});if(!s.ok)throw Error("Failed to update member");return(await s.json()).data},async deleteMember(e){if(!(await fetch(`${t}/members/${e}`,{method:"DELETE"})).ok)throw Error("Failed to delete member")},async getBooks(){let e=await fetch(`${t}/books`);if(!e.ok)throw Error("Failed to fetch books");return(await e.json()).data||[]},async createBook(e,a,r,s,n,i){let l=await fetch(`${t}/books`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({isbn:e,title:a,author:r,publisher:s,publicationYear:n,stock:i})});if(!l.ok)throw Error("Failed to create book");return(await l.json()).data},async updateBook(e,a,r,s,n,i,l){let o=await fetch(`${t}/books/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isbn:a,title:r,author:s,publisher:n,publicationYear:i,stock:l})});if(!o.ok)throw Error("Failed to update book");return(await o.json()).data},async deleteBook(e){if(!(await fetch(`${t}/books/${e}`,{method:"DELETE"})).ok)throw Error("Failed to delete book")}}])},67881,23750,e=>{"use strict";var t=e.i(43476),a=e.i(91918),r=e.i(25913),s=e.i(47163);let n=(0,r.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function i({className:e,variant:r,size:i,asChild:l=!1,...o}){let d=l?a.Slot:"button";return(0,t.jsx)(d,{"data-slot":"button",className:(0,s.cn)(n({variant:r,size:i,className:e})),...o})}function l({className:e,type:a,...r}){return(0,t.jsx)("input",{type:a,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}e.s(["Button",()=>i],67881),e.s(["Input",()=>l],23750)},7233,55436,e=>{"use strict";var t=e.i(75254);let a=(0,t.default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],7233);let r=(0,t.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);e.s(["Search",()=>r],55436)},41071,e=>{"use strict";let t=(0,e.i(75254).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>t],41071)},61122,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(70065),s=e.i(94179),n=e.i(67881),i=e.i(23750),l=e.i(11922),o=e.i(7233),d=e.i(41071),c=e.i(55436),m=e.i(63415);function u({isOpen:e,onClose:s,onSubmit:l,books:o,members:d}){let[c,m]=(0,a.useState)({memberId:"",bookId:"",dueDate:new Date().toISOString().split("T")[0]});return((0,a.useEffect)(()=>{e&&m({memberId:"",bookId:"",dueDate:new Date().toISOString().split("T")[0]})},[e]),e)?(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,t.jsxs)(r.Card,{className:"w-full max-w-md p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Buat Peminjaman Baru"}),(0,t.jsxs)("form",{onSubmit:e=>{(e.preventDefault(),c.memberId&&c.bookId)?(l({memberId:Number.parseInt(c.memberId),bookId:c.bookId,dueDate:c.dueDate}),s()):alert("Mohon lengkapi semua field")},className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Pilih Anggota"}),(0,t.jsxs)("select",{value:c.memberId,onChange:e=>m({...c,memberId:e.target.value}),className:"w-full px-3 py-2 border rounded-md bg-background",required:!0,children:[(0,t.jsx)("option",{value:"",children:"-- Pilih Anggota --"}),d.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Pilih Buku"}),(0,t.jsxs)("select",{value:c.bookId,onChange:e=>m({...c,bookId:e.target.value}),className:"w-full px-3 py-2 border rounded-md bg-background",required:!0,children:[(0,t.jsx)("option",{value:"",children:"-- Pilih Buku --"}),o.filter(e=>e.stock>0).map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.title," (",e.stock," tersedia)"]},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Tanggal Jatuh Tempo"}),(0,t.jsx)(i.Input,{type:"date",value:c.dueDate,onChange:e=>m({...c,dueDate:e.target.value})})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:s,className:"flex-1 bg-transparent",children:"Batal"}),(0,t.jsx)(n.Button,{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:"Buat Peminjaman"})]})]})]})}):null}function b({isOpen:e,onClose:s,onSubmit:l,rentalData:o}){let[d,c]=(0,a.useState)(new Date().toISOString().split("T")[0]);return((0,a.useEffect)(()=>{e&&c(new Date().toISOString().split("T")[0])},[e,o]),e)?(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,t.jsxs)(r.Card,{className:"w-full max-w-md p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Konfirmasi Pengembalian"}),(0,t.jsxs)("form",{onSubmit:e=>{(e.preventDefault(),d)?o&&o.id?(l({rentId:o.id,returnDate:d}),s()):alert("Data peminjaman tidak ditemukan."):alert("Mohon masukkan tanggal pengembalian")},className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Buku"}),(0,t.jsx)(i.Input,{value:o?.book||"",disabled:!0,className:"bg-muted"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Anggota"}),(0,t.jsx)(i.Input,{value:o?.member||"",disabled:!0,className:"bg-muted"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Tanggal Peminjaman"}),(0,t.jsx)(i.Input,{value:o?.rentDate||"",disabled:!0,className:"bg-muted"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Tanggal Pengembalian"}),(0,t.jsx)(i.Input,{type:"date",value:d,onChange:e=>c(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:s,className:"flex-1 bg-transparent",children:"Batal"}),(0,t.jsx)(n.Button,{type:"submit",className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:"Konfirmasi Pengembalian"})]})]})]})}):null}var h=e.i(91432),x=e.i(54858);function p(){let{role:e}=(0,h.useAuth)(),[p,g]=(0,a.useState)([]),[f,j]=(0,a.useState)([]),[v,y]=(0,a.useState)([]),[k,N]=(0,a.useState)(""),[w,S]=(0,a.useState)(!1),[D,I]=(0,a.useState)(!1),[T,E]=(0,a.useState)(null),[P,C]=(0,a.useState)(!0),[B,M]=(0,a.useState)("");(0,a.useEffect)(()=>{(async()=>{try{console.log(e),C(!0);let[t,a,r]=await Promise.all([x.api.getRentals(),x.api.getMembers(),x.api.getBooks()]);g(t),j(a),y(r),M("")}catch(e){console.error("Failed to load data:",e),M("Gagal memuat data. Pastikan backend berjalan di http://localhost:8080")}finally{C(!1)}console.log(e)})()},[]);let O=async e=>{try{let t=await x.api.createRental(e.memberId,e.bookId,e.dueDate);g([...p,t]),S(!1)}catch(e){console.error("Failed to create rental:",e),M("Gagal membuat peminjaman")}},R=async e=>{console.log(e);try{let t=await x.api.returnRental(e.rentId,e.returnDate);g(p.map(a=>a.id===e.rentId?t:a)),I(!1),E(null)}catch(e){console.error("Failed to return rental:",e),M("Gagal mengembalikan buku")}},$=p.filter(e=>e.member.toLowerCase().includes(k.toLowerCase())||e.book.toLowerCase().includes(k.toLowerCase()));return P?(0,t.jsx)(l.LayoutWrapper,{breadcrumbs:["Manajemen Peminjaman"],children:(0,t.jsx)("div",{className:"p-6 text-center",children:"Loading..."})}):(0,t.jsxs)(l.LayoutWrapper,{breadcrumbs:["Manajemen Peminjaman"],children:[(0,t.jsxs)("div",{className:"p-6",children:[B&&(0,t.jsx)("div",{className:"mb-4 p-4 bg-red-100 text-red-700 rounded",children:B}),(0,t.jsxs)(r.Card,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Manajemen Peminjaman"}),"ADMIN"===e&&(0,t.jsxs)(n.Button,{onClick:()=>{S(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white gap-2",children:[(0,t.jsx)(o.Plus,{className:"w-4 h-4"}),"Tambah Peminjaman"]})]}),(0,t.jsxs)("div",{className:"relative mb-6",children:[(0,t.jsx)(c.Search,{className:"absolute left-3 top-3 w-4 h-4 text-muted-foreground"}),(0,t.jsx)(i.Input,{placeholder:"Cari anggota atau buku...",value:k,onChange:e=>N(e.target.value),className:"pl-10"})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-border",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-foreground",children:"ID Peminjaman"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-foreground",children:"Anggota"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-foreground",children:"Buku"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-foreground",children:"Tanggal Pinjam"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-foreground",children:"Tanggal Kembali"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-foreground",children:"Status"}),"ADMIN"===e&&(0,t.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-foreground",children:"Aksi"})]})}),(0,t.jsx)("tbody",{children:$.length>0?$.map(a=>(0,t.jsxs)("tr",{className:"border-b border-border hover:bg-muted",children:[(0,t.jsxs)("td",{className:"py-3 px-4 font-medium",children:["#",a.id]}),(0,t.jsx)("td",{className:"py-3 px-4",children:a.member}),(0,t.jsx)("td",{className:"py-3 px-4",children:a.book}),(0,t.jsx)("td",{className:"py-3 px-4 text-sm",children:a.rentDate}),(0,t.jsx)("td",{className:"py-3 px-4 text-sm",children:a.returnDate||"-"}),(0,t.jsx)("td",{className:"py-3 px-4",children:(0,t.jsx)(s.Badge,{variant:"RETURNED"===a.status?"default":"OVERDUE"===a.status?"destructive":"secondary",children:"RETURNED"===a.status?"Dikembalikan":"OVERDUE"===a.status?"Terlambat":"Dipinjam"})}),"ADMIN"===e&&(0,t.jsx)("td",{className:"py-3 px-4",children:(0,t.jsxs)(m.DropdownMenu,{children:[(0,t.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)("button",{className:"p-1 hover:bg-muted rounded",children:(0,t.jsx)(d.MoreHorizontal,{className:"w-4 h-4 text-foreground"})})}),(0,t.jsx)(m.DropdownMenuContent,{align:"end",children:"RETURNED"!==a.status&&(0,t.jsx)(m.DropdownMenuItem,{onClick:()=>{console.log("rentallll"),console.log(a),E(a),I(!0)},children:"Konfirmasi Kembali"})})]})})]},a.id)):(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:"ADMIN"===e?7:6,className:"text-center py-10 text-muted-foreground",children:"Tidak ada data peminjaman ditemukan."})})})]})})]})]}),(0,t.jsx)(u,{isOpen:w,onClose:()=>S(!1),onSubmit:O,books:v,members:f}),(0,t.jsx)(b,{isOpen:D,onClose:()=>I(!1),onSubmit:R,rentalData:T})]})}e.s(["default",()=>p],61122)}]);